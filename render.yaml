services:
  # Single Web Service (Monolith)
  - type: web
    name: petcarex-app
    runtime: node
    rootDir: src/application
    # Build command: Install root deps (if any), install client deps & build, install server deps
    # The 'build' script in package.json now handles this chain.
    buildCommand: npm run build
    # Start command: Starts the Express server
    startCommand: npm start
    envVars:
      - key: DATABASE_URL
        sync: false # User must provide this secret in the Render Dashboard
      - key: NODE_ENV
        value: production
      # We don't need VITE_API_URL because the app is served from the same origin,
      # and the client defaults to sending requests to /api, which works perfectly.
